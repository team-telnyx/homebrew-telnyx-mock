# typed: false
# frozen_string_literal: true

# This file was generated by GoReleaser. DO NOT EDIT.
class TelnyxMock < Formula
  desc "telnyx-mock is a mock HTTP server that responds like the real Telnyx API. It can be used instead of Telnyx's testmode to make test suites integrating with Telnyx faster and less brittle."
  homepage "https://github.com/team-telnyx/telnyx-mock"
  version "0.8.15"
  bottle :unneeded

  on_macos do
    if Hardware::CPU.intel?
      url "https://github.com/team-telnyx/telnyx-mock/releases/download/v0.8.15/telnyx-mock_0.8.15_darwin_amd64.tar.gz"
      sha256 "13d1a2759fa91453adb1de4331022b04594ece0e0c60a3230a78b7177111cc49"
    end
  end

  on_linux do
    if Hardware::CPU.intel?
      url "https://github.com/team-telnyx/telnyx-mock/releases/download/v0.8.15/telnyx-mock_0.8.15_linux_amd64.tar.gz"
      sha256 "7d3b921ebf43102c8e63c83996574c46232cb092b5707b2ac32bc36bf2cb0e8a"
    end
  end

  def install
    bin.install "telnyx-mock"
  end

  plist_options :startup => false

  def plist; <<~EOS
    <?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
  <dict>
    <key>KeepAlive</key>
    <dict>
      <key>SuccessfulExit</key>
      <false/>
    </dict>
    <key>Label</key>
    <string>#{plist_name}</string>
    <key>ProgramArguments</key>
    <array>
      <string>#{opt_bin}/telnyx-mock</string>
      <string>-http-port</string>
      <string>12111</string>
      <string>-https-port</string>
      <string>12112</string>
    </array>
    <key>RunAtLoad</key>
    <true/>
    <key>WorkingDirectory</key>
    <string>#{var}</string>
    <key>StandardErrorPath</key>
    <string>#{var}/log/telnyx-mock.log</string>
    <key>StandardOutPath</key>
    <string>#{var}/log/telnyx-mock.log</string>
  </dict>
</plist>

  EOS
  end
end
